---
read_when:
  - ä½ æƒ³å…¨é¢äº†è§£ KrabKrab çš„ OAuth æµç¨‹
  - ä½ é‡åˆ°äº†ä»¤ç‰Œå¤±æ•ˆ/ç™»å‡ºé—®é¢˜
  - ä½ æƒ³äº†è§£ setup-token æˆ– OAuth è®¤è¯æµç¨‹
  - ä½ æƒ³ä½¿ç”¨å¤šè´¦æˆ·æˆ–é…ç½®æ–‡ä»¶è·¯ç”±
summary: KrabKrab ä¸­çš„ OAuthï¼šä»¤ç‰Œäº¤æ¢ã€å­˜å‚¨å’Œå¤šè´¦æˆ·æ¨¡å¼
title: OAuth
x-i18n:
  generated_at: "2026-02-01T20:23:29Z"
  model: claude-opus-4-5
  provider: pi
  source_hash: af714bdadc4a89295a18da1eba5f5b857c8d533ebabe9b0758b722fe60c36124
  source_path: concepts/oauth.md
  workflow: 14
---

# OAuth

KrabKrab æ”¯æŒé€šè¿‡ OAuth è¿›è¡Œ"è®¢é˜…è®¤è¯"ï¼Œé€‚ç”¨äºŽæä¾›æ­¤åŠŸèƒ½çš„æä¾›å•†ï¼ˆç‰¹åˆ«æ˜¯ **OpenAI Codexï¼ˆChatGPT OAuthï¼‰**ï¼‰ã€‚å¯¹äºŽ Anthropic è®¢é˜…ï¼Œè¯·ä½¿ç”¨ **setup-token** æµç¨‹ã€‚æœ¬é¡µè¯´æ˜Žï¼š

- OAuth **ä»¤ç‰Œäº¤æ¢**çš„å·¥ä½œåŽŸç†ï¼ˆPKCEï¼‰
- ä»¤ç‰Œ**å­˜å‚¨**åœ¨å“ªé‡Œï¼ˆä»¥åŠåŽŸå› ï¼‰
- å¦‚ä½•å¤„ç†**å¤šè´¦æˆ·**ï¼ˆé…ç½®æ–‡ä»¶ + æŒ‰ä¼šè¯è¦†ç›–ï¼‰

KrabKrab è¿˜æ”¯æŒ**æä¾›å•†æ’ä»¶**ï¼Œå®ƒä»¬è‡ªå¸¦ OAuth æˆ– API å¯†é’¥æµç¨‹ã€‚é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿è¡Œï¼š

```bash
krabkrab models auth login --provider <id>
```

## ä»¤ç‰Œæ±‡èšç‚¹ï¼ˆä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼‰

OAuth æä¾›å•†é€šå¸¸åœ¨ç™»å½•/åˆ·æ–°æµç¨‹ä¸­å‘æ”¾**æ–°çš„åˆ·æ–°ä»¤ç‰Œ**ã€‚æŸäº›æä¾›å•†ï¼ˆæˆ– OAuth å®¢æˆ·ç«¯ï¼‰åœ¨ä¸ºåŒä¸€ç”¨æˆ·/åº”ç”¨å‘æ”¾æ–°ä»¤ç‰Œæ—¶ï¼Œå¯èƒ½ä¼šä½¿æ—§çš„åˆ·æ–°ä»¤ç‰Œå¤±æ•ˆã€‚

å®žé™…ç—‡çŠ¶ï¼š

- ä½ é€šè¿‡ KrabKrab _å’Œ_ Claude Code / Codex CLI ç™»å½• â†’ å…¶ä¸­ä¸€ä¸ªç¨åŽä¼šéšæœº"ç™»å‡º"

ä¸ºå‡å°‘è¿™ç§æƒ…å†µï¼ŒKrabKrab å°† `auth-profiles.json` è§†ä¸º**ä»¤ç‰Œæ±‡èšç‚¹**ï¼š

- è¿è¡Œæ—¶ä»Ž**åŒä¸€ä¸ªä½ç½®**è¯»å–å‡­æ®
- æˆ‘ä»¬å¯ä»¥ä¿ç•™å¤šä¸ªé…ç½®æ–‡ä»¶å¹¶ç¡®å®šæ€§åœ°è·¯ç”±å®ƒä»¬

## å­˜å‚¨ï¼ˆä»¤ç‰Œå­˜æ”¾ä½ç½®ï¼‰

å¯†é’¥æŒ‰**æ™ºèƒ½ä½“**å­˜å‚¨ï¼š

- è®¤è¯é…ç½®æ–‡ä»¶ï¼ˆOAuth + API å¯†é’¥ï¼‰ï¼š`~/.krabkrab/agents/<agentId>/agent/auth-profiles.json`
- è¿è¡Œæ—¶ç¼“å­˜ï¼ˆè‡ªåŠ¨ç®¡ç†ï¼›è¯·å‹¿ç¼–è¾‘ï¼‰ï¼š`~/.krabkrab/agents/<agentId>/agent/auth.json`

ä»…ç”¨äºŽå¯¼å…¥çš„æ—§ç‰ˆæ–‡ä»¶ï¼ˆä»ç„¶æ”¯æŒï¼Œä½†ä¸æ˜¯ä¸»å­˜å‚¨ï¼‰ï¼š

- `~/.krabkrab/credentials/oauth.json`ï¼ˆé¦–æ¬¡ä½¿ç”¨æ—¶å¯¼å…¥åˆ° `auth-profiles.json`ï¼‰

ä»¥ä¸Šæ‰€æœ‰è·¯å¾„ä¹Ÿéµå¾ª `$krabkrab_STATE_DIR`ï¼ˆçŠ¶æ€ç›®å½•è¦†ç›–ï¼‰ã€‚å®Œæ•´å‚è€ƒï¼š[/gateway/configuration](/gateway/configuration#auth-storage-oauth--api-keys)

## Anthropic setup-tokenï¼ˆè®¢é˜…è®¤è¯ï¼‰

åœ¨ä»»æ„æœºå™¨ä¸Šè¿è¡Œ `claude setup-token`ï¼Œç„¶åŽå°†å…¶ç²˜è´´åˆ° KrabKrab ä¸­ï¼š

```bash
krabkrab models auth setup-token --provider anthropic
```

å¦‚æžœä½ åœ¨å…¶ä»–åœ°æ–¹ç”Ÿæˆäº†ä»¤ç‰Œï¼Œå¯ä»¥æ‰‹åŠ¨ç²˜è´´ï¼š

```bash
krabkrab models auth paste-token --provider anthropic
```

éªŒè¯ï¼š

```bash
krabkrab models status
```

## OAuth äº¤æ¢ï¼ˆç™»å½•å·¥ä½œåŽŸç†ï¼‰

KrabKrab çš„äº¤äº’å¼ç™»å½•æµç¨‹åœ¨ `@mariozechner/pi-ai` ä¸­å®žçŽ°ï¼Œå¹¶é›†æˆåˆ°å‘å¯¼/å‘½ä»¤ä¸­ã€‚

### Anthropicï¼ˆClaude Pro/Maxï¼‰setup-token

æµç¨‹æ¦‚è¦ï¼š

1. è¿è¡Œ `claude setup-token`
2. å°†ä»¤ç‰Œç²˜è´´åˆ° KrabKrab
3. ä½œä¸ºä»¤ç‰Œè®¤è¯é…ç½®æ–‡ä»¶å­˜å‚¨ï¼ˆæ— åˆ·æ–°ï¼‰

å‘å¯¼è·¯å¾„ä¸º `krabkrab onboard` â†’ è®¤è¯é€‰æ‹© `setup-token`ï¼ˆAnthropicï¼‰ã€‚

### OpenAI Codexï¼ˆChatGPT OAuthï¼‰

æµç¨‹æ¦‚è¦ï¼ˆPKCEï¼‰ï¼š

1. ç”Ÿæˆ PKCE éªŒè¯å™¨/è´¨è¯¢ + éšæœº `state`
2. æ‰“å¼€ `https://auth.openai.com/oauth/authorize?...`
3. å°è¯•åœ¨ `http://127.0.0.1:1455/auth/callback` æ•èŽ·å›žè°ƒ
4. å¦‚æžœå›žè°ƒæ— æ³•ç»‘å®šï¼ˆæˆ–ä½ åœ¨è¿œç¨‹/æ— å¤´çŽ¯å¢ƒä¸­ï¼‰ï¼Œæ‰‹åŠ¨ç²˜è´´é‡å®šå‘ URL/ä»£ç 
5. åœ¨ `https://auth.openai.com/oauth/token` è¿›è¡Œäº¤æ¢
6. ä»Žè®¿é—®ä»¤ç‰Œä¸­æå– `accountId` å¹¶å­˜å‚¨ `{ access, refresh, expires, accountId }`

å‘å¯¼è·¯å¾„ä¸º `krabkrab onboard` â†’ è®¤è¯é€‰æ‹© `openai-codex`ã€‚

## åˆ·æ–° + è¿‡æœŸ

é…ç½®æ–‡ä»¶å­˜å‚¨ `expires` æ—¶é—´æˆ³ã€‚

è¿è¡Œæ—¶ï¼š

- å¦‚æžœ `expires` åœ¨æœªæ¥ â†’ ä½¿ç”¨å·²å­˜å‚¨çš„è®¿é—®ä»¤ç‰Œ
- å¦‚æžœå·²è¿‡æœŸ â†’ åˆ·æ–°ï¼ˆåœ¨æ–‡ä»¶é”ä¸‹ï¼‰å¹¶è¦†ç›–å·²å­˜å‚¨çš„å‡­æ®

åˆ·æ–°æµç¨‹æ˜¯è‡ªåŠ¨çš„ï¼›ä½ é€šå¸¸ä¸éœ€è¦æ‰‹åŠ¨ç®¡ç†ä»¤ç‰Œã€‚

## å¤šè´¦æˆ·ï¼ˆé…ç½®æ–‡ä»¶ï¼‰+ è·¯ç”±

ä¸¤ç§æ¨¡å¼ï¼š

### 1ï¼‰æŽ¨èï¼šç‹¬ç«‹æ™ºèƒ½ä½“

å¦‚æžœä½ å¸Œæœ›"ä¸ªäºº"å’Œ"å·¥ä½œ"æ°¸è¿œä¸äº¤å‰ï¼Œè¯·ä½¿ç”¨éš”ç¦»çš„æ™ºèƒ½ä½“ï¼ˆç‹¬ç«‹çš„ä¼šè¯ + å‡­æ® + å·¥ä½œåŒºï¼‰ï¼š

```bash
krabkrab agents add work
krabkrab agents add personal
```

ç„¶åŽæŒ‰æ™ºèƒ½ä½“é…ç½®è®¤è¯ï¼ˆå‘å¯¼ï¼‰ï¼Œå¹¶å°†èŠå¤©è·¯ç”±åˆ°æ­£ç¡®çš„æ™ºèƒ½ä½“ã€‚

### 2ï¼‰é«˜çº§ï¼šå•ä¸ªæ™ºèƒ½ä½“ä¸­çš„å¤šä¸ªé…ç½®æ–‡ä»¶

`auth-profiles.json` æ”¯æŒåŒä¸€æä¾›å•†çš„å¤šä¸ªé…ç½®æ–‡ä»¶ IDã€‚

é€‰æ‹©ä½¿ç”¨å“ªä¸ªé…ç½®æ–‡ä»¶ï¼š

- é€šè¿‡é…ç½®é¡ºåºå…¨å±€è®¾ç½®ï¼ˆ`auth.order`ï¼‰
- é€šè¿‡ `/model ...@<profileId>` æŒ‰ä¼šè¯è®¾ç½®

ç¤ºä¾‹ï¼ˆä¼šè¯è¦†ç›–ï¼‰ï¼š

- `/model Opus@anthropic:work`

å¦‚ä½•æŸ¥çœ‹å­˜åœ¨å“ªäº›é…ç½®æ–‡ä»¶ IDï¼š

- `krabkrab channels list --json`ï¼ˆæ˜¾ç¤º `auth[]`ï¼‰

ç›¸å…³æ–‡æ¡£ï¼š

- [/concepts/model-failover](/concepts/model-failover)ï¼ˆè½®æ¢ + å†·å´è§„åˆ™ï¼‰
- [/tools/slash-commands](/tools/slash-commands)ï¼ˆå‘½ä»¤ç•Œé¢ï¼‰

