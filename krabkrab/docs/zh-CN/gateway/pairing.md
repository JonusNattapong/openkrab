---
read_when:
  - åœ¨æ²¡æœ‰ macOS UI çš„æƒ…å†µä¸‹å®žçŽ°èŠ‚ç‚¹é…å¯¹å®¡æ‰¹
  - æ·»åŠ ç”¨äºŽå®¡æ‰¹è¿œç¨‹èŠ‚ç‚¹çš„ CLI æµç¨‹
  - æ‰©å±• Gateway ç½‘å…³åè®®ä»¥æ”¯æŒèŠ‚ç‚¹ç®¡ç†
summary: Gateway ç½‘å…³æ‹¥æœ‰çš„èŠ‚ç‚¹é…å¯¹ï¼ˆé€‰é¡¹ Bï¼‰ï¼Œç”¨äºŽ iOS å’Œå…¶ä»–è¿œç¨‹èŠ‚ç‚¹
title: Gateway ç½‘å…³æ‹¥æœ‰çš„é…å¯¹
x-i18n:
  generated_at: "2026-02-03T07:48:32Z"
  model: claude-opus-4-5
  provider: pi
  source_hash: 1f5154292a75ea2c1470324babc99c6c46a5e4e16afb394ed323d28f6168f459
  source_path: gateway/pairing.md
  workflow: 15
---

# Gateway ç½‘å…³æ‹¥æœ‰çš„é…å¯¹ï¼ˆé€‰é¡¹ Bï¼‰

åœ¨ Gateway ç½‘å…³æ‹¥æœ‰çš„é…å¯¹ä¸­ï¼Œ**Gateway ç½‘å…³**æ˜¯å…è®¸å“ªäº›èŠ‚ç‚¹åŠ å…¥çš„å”¯ä¸€ä¿¡æ¯æºã€‚UIï¼ˆmacOS åº”ç”¨ã€æœªæ¥çš„å®¢æˆ·ç«¯ï¼‰åªæ˜¯å®¡æ‰¹æˆ–æ‹’ç»å¾…å¤„ç†è¯·æ±‚çš„å‰ç«¯ã€‚

**é‡è¦ï¼š**WS èŠ‚ç‚¹åœ¨ `connect` æœŸé—´ä½¿ç”¨**è®¾å¤‡é…å¯¹**ï¼ˆè§’è‰² `node`ï¼‰ã€‚`node.pair.*` æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é…å¯¹å­˜å‚¨ï¼Œ**ä¸ä¼š**é™åˆ¶ WS æ¡æ‰‹ã€‚åªæœ‰æ˜¾å¼è°ƒç”¨ `node.pair.*` çš„å®¢æˆ·ç«¯ä½¿ç”¨æ­¤æµç¨‹ã€‚

## æ¦‚å¿µ

- **å¾…å¤„ç†è¯·æ±‚**ï¼šä¸€ä¸ªèŠ‚ç‚¹è¯·æ±‚åŠ å…¥ï¼›éœ€è¦å®¡æ‰¹ã€‚
- **å·²é…å¯¹èŠ‚ç‚¹**ï¼šå·²æ‰¹å‡†çš„èŠ‚ç‚¹ï¼Œå¸¦æœ‰å·²é¢å‘çš„è®¤è¯ä»¤ç‰Œã€‚
- **ä¼ è¾“å±‚**ï¼šGateway ç½‘å…³ WS ç«¯ç‚¹è½¬å‘è¯·æ±‚ä½†ä¸å†³å®šæˆå‘˜èµ„æ ¼ã€‚ï¼ˆæ—§ç‰ˆ TCP æ¡¥æŽ¥æ”¯æŒå·²å¼ƒç”¨/ç§»é™¤ã€‚ï¼‰

## é…å¯¹å·¥ä½œåŽŸç†

1. èŠ‚ç‚¹è¿žæŽ¥åˆ° Gateway ç½‘å…³ WS å¹¶è¯·æ±‚é…å¯¹ã€‚
2. Gateway ç½‘å…³å­˜å‚¨ä¸€ä¸ª**å¾…å¤„ç†è¯·æ±‚**å¹¶å‘å‡º `node.pair.requested`ã€‚
3. ä½ å®¡æ‰¹æˆ–æ‹’ç»è¯¥è¯·æ±‚ï¼ˆCLI æˆ– UIï¼‰ã€‚
4. å®¡æ‰¹åŽï¼ŒGateway ç½‘å…³é¢å‘ä¸€ä¸ª**æ–°ä»¤ç‰Œ**ï¼ˆé‡æ–°é…å¯¹æ—¶ä»¤ç‰Œä¼šè½®æ¢ï¼‰ã€‚
5. èŠ‚ç‚¹ä½¿ç”¨è¯¥ä»¤ç‰Œé‡æ–°è¿žæŽ¥ï¼ŒçŽ°åœ¨æ˜¯"å·²é…å¯¹"çŠ¶æ€ã€‚

å¾…å¤„ç†è¯·æ±‚åœ¨ **5 åˆ†é’Ÿ**åŽè‡ªåŠ¨è¿‡æœŸã€‚

## CLI å·¥ä½œæµç¨‹ï¼ˆæ”¯æŒæ— å¤´æ¨¡å¼ï¼‰

```bash
krabkrab nodes pending
krabkrab nodes approve <requestId>
krabkrab nodes reject <requestId>
krabkrab nodes status
krabkrab nodes rename --node <id|name|ip> --name "Living Room iPad"
```

`nodes status` æ˜¾ç¤ºå·²é…å¯¹/å·²è¿žæŽ¥çš„èŠ‚ç‚¹åŠå…¶åŠŸèƒ½ã€‚

## API æŽ¥å£ï¼ˆGateway ç½‘å…³åè®®ï¼‰

äº‹ä»¶ï¼š

- `node.pair.requested` â€” åˆ›å»ºæ–°çš„å¾…å¤„ç†è¯·æ±‚æ—¶å‘å‡ºã€‚
- `node.pair.resolved` â€” è¯·æ±‚è¢«æ‰¹å‡†/æ‹’ç»/è¿‡æœŸæ—¶å‘å‡ºã€‚

æ–¹æ³•ï¼š

- `node.pair.request` â€” åˆ›å»ºæˆ–å¤ç”¨å¾…å¤„ç†è¯·æ±‚ã€‚
- `node.pair.list` â€” åˆ—å‡ºå¾…å¤„ç† + å·²é…å¯¹çš„èŠ‚ç‚¹ã€‚
- `node.pair.approve` â€” æ‰¹å‡†å¾…å¤„ç†è¯·æ±‚ï¼ˆé¢å‘ä»¤ç‰Œï¼‰ã€‚
- `node.pair.reject` â€” æ‹’ç»å¾…å¤„ç†è¯·æ±‚ã€‚
- `node.pair.verify` â€” éªŒè¯ `{ nodeId, token }`ã€‚

æ³¨æ„äº‹é¡¹ï¼š

- `node.pair.request` å¯¹æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¹‚ç­‰çš„ï¼šé‡å¤è°ƒç”¨è¿”å›žç›¸åŒçš„å¾…å¤„ç†è¯·æ±‚ã€‚
- å®¡æ‰¹**æ€»æ˜¯**ç”Ÿæˆæ–°çš„ä»¤ç‰Œï¼›`node.pair.request` æ°¸è¿œä¸ä¼šè¿”å›žä»¤ç‰Œã€‚
- è¯·æ±‚å¯ä»¥åŒ…å« `silent: true` ä½œä¸ºè‡ªåŠ¨å®¡æ‰¹æµç¨‹çš„æç¤ºã€‚

## è‡ªåŠ¨å®¡æ‰¹ï¼ˆmacOS åº”ç”¨ï¼‰

å½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼ŒmacOS åº”ç”¨å¯ä»¥é€‰æ‹©å°è¯•**é™é»˜å®¡æ‰¹**ï¼š

- è¯·æ±‚æ ‡è®°ä¸º `silent`ï¼Œä¸”
- åº”ç”¨å¯ä»¥ä½¿ç”¨ç›¸åŒç”¨æˆ·éªŒè¯åˆ° Gateway ç½‘å…³ä¸»æœºçš„ SSH è¿žæŽ¥ã€‚

å¦‚æžœé™é»˜å®¡æ‰¹å¤±è´¥ï¼Œåˆ™å›žé€€åˆ°æ­£å¸¸çš„"æ‰¹å‡†/æ‹’ç»"æç¤ºã€‚

## å­˜å‚¨ï¼ˆæœ¬åœ°ï¼Œç§æœ‰ï¼‰

é…å¯¹çŠ¶æ€å­˜å‚¨åœ¨ Gateway ç½‘å…³çŠ¶æ€ç›®å½•ä¸‹ï¼ˆé»˜è®¤ `~/.krabkrab`ï¼‰ï¼š

- `~/.krabkrab/nodes/paired.json`
- `~/.krabkrab/nodes/pending.json`

å¦‚æžœä½ è¦†ç›–äº† `krabkrab_STATE_DIR`ï¼Œ`nodes/` æ–‡ä»¶å¤¹ä¼šéšä¹‹ç§»åŠ¨ã€‚

å®‰å…¨æ³¨æ„äº‹é¡¹ï¼š

- ä»¤ç‰Œæ˜¯æœºå¯†ä¿¡æ¯ï¼›å°† `paired.json` è§†ä¸ºæ•æ„Ÿæ–‡ä»¶ã€‚
- è½®æ¢ä»¤ç‰Œéœ€è¦é‡æ–°å®¡æ‰¹ï¼ˆæˆ–åˆ é™¤èŠ‚ç‚¹æ¡ç›®ï¼‰ã€‚

## ä¼ è¾“å±‚è¡Œä¸º

- ä¼ è¾“å±‚æ˜¯**æ— çŠ¶æ€çš„**ï¼›å®ƒä¸å­˜å‚¨æˆå‘˜èµ„æ ¼ã€‚
- å¦‚æžœ Gateway ç½‘å…³ç¦»çº¿æˆ–é…å¯¹è¢«ç¦ç”¨ï¼ŒèŠ‚ç‚¹æ— æ³•é…å¯¹ã€‚
- å¦‚æžœ Gateway ç½‘å…³å¤„äºŽè¿œç¨‹æ¨¡å¼ï¼Œé…å¯¹ä»ç„¶é’ˆå¯¹è¿œç¨‹ Gateway ç½‘å…³çš„å­˜å‚¨è¿›è¡Œã€‚

