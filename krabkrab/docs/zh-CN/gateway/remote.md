---
read_when:
  - è¿è¡Œæˆ–æŽ’æŸ¥è¿œç¨‹ Gateway ç½‘å…³è®¾ç½®é—®é¢˜
summary: ä½¿ç”¨ SSH éš§é“ï¼ˆGateway WSï¼‰å’Œ tailnet è¿›è¡Œè¿œç¨‹è®¿é—®
title: è¿œç¨‹è®¿é—®
x-i18n:
  generated_at: "2026-02-03T07:48:40Z"
  model: claude-opus-4-5
  provider: pi
  source_hash: 7e00bd2e048dfbd829913bef0f40a791b8d8c3e2f8a115fc0a13b03f136ebc93
  source_path: gateway/remote.md
  workflow: 15
---

# è¿œç¨‹è®¿é—®ï¼ˆSSHã€éš§é“å’Œ tailnetï¼‰

æœ¬ä»“åº“é€šè¿‡åœ¨ä¸“ç”¨ä¸»æœºï¼ˆæ¡Œé¢/æœåŠ¡å™¨ï¼‰ä¸Šè¿è¡Œå•ä¸ª Gateway ç½‘å…³ï¼ˆä¸»èŠ‚ç‚¹ï¼‰å¹¶è®©å®¢æˆ·ç«¯è¿žæŽ¥åˆ°å®ƒæ¥æ”¯æŒ"SSH è¿œç¨‹"ã€‚

- å¯¹äºŽ**æ“ä½œå‘˜ï¼ˆä½ /macOS åº”ç”¨ï¼‰**ï¼šSSH éš§é“æ˜¯é€šç”¨çš„å›žé€€æ–¹æ¡ˆã€‚
- å¯¹äºŽ**èŠ‚ç‚¹ï¼ˆiOS/Android å’Œæœªæ¥çš„è®¾å¤‡ï¼‰**ï¼šè¿žæŽ¥åˆ° Gateway **WebSocket**ï¼ˆLAN/tailnet æˆ–æ ¹æ®éœ€è¦é€šè¿‡ SSH éš§é“ï¼‰ã€‚

## æ ¸å¿ƒç†å¿µ

- Gateway WebSocket ç»‘å®šåˆ°ä½ é…ç½®ç«¯å£çš„ **loopback**ï¼ˆé»˜è®¤ä¸º 18789ï¼‰ã€‚
- å¯¹äºŽè¿œç¨‹ä½¿ç”¨ï¼Œä½ é€šè¿‡ SSH è½¬å‘è¯¥ loopback ç«¯å£ï¼ˆæˆ–ä½¿ç”¨ tailnet/VPN å‡å°‘éš§é“éœ€æ±‚ï¼‰ã€‚

## å¸¸è§çš„ VPN/tailnet è®¾ç½®ï¼ˆæ™ºèƒ½ä½“æ‰€åœ¨ä½ç½®ï¼‰

å°† **Gateway ç½‘å…³ä¸»æœº**è§†ä¸º"æ™ºèƒ½ä½“æ‰€åœ¨çš„ä½ç½®"ã€‚å®ƒæ‹¥æœ‰ä¼šè¯ã€èº«ä»½éªŒè¯é…ç½®æ–‡ä»¶ã€æ¸ é“å’ŒçŠ¶æ€ã€‚
ä½ çš„ç¬”è®°æœ¬ç”µè„‘/æ¡Œé¢ï¼ˆå’ŒèŠ‚ç‚¹ï¼‰è¿žæŽ¥åˆ°è¯¥ä¸»æœºã€‚

### 1) tailnet ä¸­å§‹ç»ˆåœ¨çº¿çš„ Gateway ç½‘å…³ï¼ˆVPS æˆ–å®¶åº­æœåŠ¡å™¨ï¼‰

åœ¨æŒä¹…ä¸»æœºä¸Šè¿è¡Œ Gateway ç½‘å…³ï¼Œå¹¶é€šè¿‡ **Tailscale** æˆ– SSH è®¿é—®å®ƒã€‚

- **æœ€ä½³ç”¨æˆ·ä½“éªŒï¼š** ä¿æŒ `gateway.bind: "loopback"` å¹¶ä½¿ç”¨ **Tailscale Serve** ä½œä¸ºæŽ§åˆ¶ UIã€‚
- **å›žé€€æ–¹æ¡ˆï¼š** ä¿æŒ loopback + ä»Žä»»ä½•éœ€è¦è®¿é—®çš„æœºå™¨å»ºç«‹ SSH éš§é“ã€‚
- **ç¤ºä¾‹ï¼š** [exe.dev](/install/exe-dev)ï¼ˆç®€æ˜“ VMï¼‰æˆ– [Hetzner](/install/hetzner)ï¼ˆç”Ÿäº§ VPSï¼‰ã€‚

å½“ä½ çš„ç¬”è®°æœ¬ç”µè„‘ç»å¸¸ä¼‘çœ ä½†ä½ å¸Œæœ›æ™ºèƒ½ä½“å§‹ç»ˆåœ¨çº¿æ—¶ï¼Œè¿™æ˜¯ç†æƒ³çš„é€‰æ‹©ã€‚

### 2) å®¶åº­æ¡Œé¢è¿è¡Œ Gateway ç½‘å…³ï¼Œç¬”è®°æœ¬ç”µè„‘ä½œä¸ºè¿œç¨‹æŽ§åˆ¶

ç¬”è®°æœ¬ç”µè„‘**ä¸**è¿è¡Œæ™ºèƒ½ä½“ã€‚å®ƒè¿œç¨‹è¿žæŽ¥ï¼š

- ä½¿ç”¨ macOS åº”ç”¨çš„ **Remote over SSH** æ¨¡å¼ï¼ˆè®¾ç½® â†’ é€šç”¨ â†’ "KrabKrab runs"ï¼‰ã€‚
- åº”ç”¨æ‰“å¼€å¹¶ç®¡ç†éš§é“ï¼Œå› æ­¤ WebChat + å¥åº·æ£€æŸ¥"ç›´æŽ¥å·¥ä½œ"ã€‚

æ“ä½œæ‰‹å†Œï¼š[macOS è¿œç¨‹è®¿é—®](/platforms/mac/remote)ã€‚

### 3) ç¬”è®°æœ¬ç”µè„‘è¿è¡Œ Gateway ç½‘å…³ï¼Œä»Žå…¶ä»–æœºå™¨è¿œç¨‹è®¿é—®

ä¿æŒ Gateway ç½‘å…³åœ¨æœ¬åœ°ä½†å®‰å…¨åœ°æš´éœ²å®ƒï¼š

- ä»Žå…¶ä»–æœºå™¨åˆ°ç¬”è®°æœ¬ç”µè„‘çš„ SSH éš§é“ï¼Œæˆ–
- Tailscale Serve æŽ§åˆ¶ UI å¹¶ä¿æŒ Gateway ç½‘å…³ä»… loopbackã€‚

æŒ‡å—ï¼š[Tailscale](/gateway/tailscale) å’Œ [Web æ¦‚è§ˆ](/web)ã€‚

## å‘½ä»¤æµï¼ˆä»€ä¹ˆåœ¨å“ªé‡Œè¿è¡Œï¼‰

ä¸€ä¸ª Gateway ç½‘å…³æœåŠ¡æ‹¥æœ‰çŠ¶æ€ + æ¸ é“ã€‚èŠ‚ç‚¹æ˜¯å¤–å›´è®¾å¤‡ã€‚

æµç¨‹ç¤ºä¾‹ï¼ˆTelegram â†’ èŠ‚ç‚¹ï¼‰ï¼š

- Telegram æ¶ˆæ¯åˆ°è¾¾ **Gateway ç½‘å…³**ã€‚
- Gateway ç½‘å…³è¿è¡Œ**æ™ºèƒ½ä½“**å¹¶å†³å®šæ˜¯å¦è°ƒç”¨èŠ‚ç‚¹å·¥å…·ã€‚
- Gateway ç½‘å…³é€šè¿‡ Gateway WebSocket è°ƒç”¨**èŠ‚ç‚¹**ï¼ˆ`node.*` RPCï¼‰ã€‚
- èŠ‚ç‚¹è¿”å›žç»“æžœï¼›Gateway ç½‘å…³å›žå¤åˆ° Telegramã€‚

è¯´æ˜Žï¼š

- **èŠ‚ç‚¹ä¸è¿è¡Œ Gateway ç½‘å…³æœåŠ¡ã€‚** é™¤éžä½ æœ‰æ„è¿è¡Œéš”ç¦»çš„é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™æ¯å°ä¸»æœºåªåº”è¿è¡Œä¸€ä¸ª Gateway ç½‘å…³ï¼ˆå‚è§[å¤š Gateway ç½‘å…³](/gateway/multiple-gateways)ï¼‰ã€‚
- macOS åº”ç”¨çš„"èŠ‚ç‚¹æ¨¡å¼"åªæ˜¯é€šè¿‡ Gateway WebSocket çš„èŠ‚ç‚¹å®¢æˆ·ç«¯ã€‚

## SSH éš§é“ï¼ˆCLI + å·¥å…·ï¼‰

åˆ›å»ºåˆ°è¿œç¨‹ Gateway WS çš„æœ¬åœ°éš§é“ï¼š

```bash
ssh -N -L 18789:127.0.0.1:18789 user@host
```

éš§é“å»ºç«‹åŽï¼š

- `krabkrab health` å’Œ `krabkrab status --deep` çŽ°åœ¨é€šè¿‡ `ws://127.0.0.1:18789` è®¿é—®è¿œç¨‹ Gateway ç½‘å…³ã€‚
- `krabkrab gateway {status,health,send,agent,call}` åœ¨éœ€è¦æ—¶ä¹Ÿå¯ä»¥é€šè¿‡ `--url` æŒ‡å®šè½¬å‘çš„ URLã€‚

æ³¨æ„ï¼šå°† `18789` æ›¿æ¢ä¸ºä½ é…ç½®çš„ `gateway.port`ï¼ˆæˆ– `--port`/`krabkrab_GATEWAY_PORT`ï¼‰ã€‚

## CLI è¿œç¨‹é»˜è®¤å€¼

ä½ å¯ä»¥æŒä¹…åŒ–è¿œç¨‹ç›®æ ‡ï¼Œä»¥ä¾¿ CLI å‘½ä»¤é»˜è®¤ä½¿ç”¨å®ƒï¼š

```json5
{
  gateway: {
    mode: "remote",
    remote: {
      url: "ws://127.0.0.1:18789",
      token: "your-token",
    },
  },
}
```

å½“ Gateway ç½‘å…³ä»…é™ loopback æ—¶ï¼Œä¿æŒ URL ä¸º `ws://127.0.0.1:18789` å¹¶å…ˆæ‰“å¼€ SSH éš§é“ã€‚

## é€šè¿‡ SSH çš„èŠå¤© UI

WebChat ä¸å†ä½¿ç”¨å•ç‹¬çš„ HTTP ç«¯å£ã€‚SwiftUI èŠå¤© UI ç›´æŽ¥è¿žæŽ¥åˆ° Gateway WebSocketã€‚

- é€šè¿‡ SSH è½¬å‘ `18789`ï¼ˆè§ä¸Šæ–‡ï¼‰ï¼Œç„¶åŽè®©å®¢æˆ·ç«¯è¿žæŽ¥åˆ° `ws://127.0.0.1:18789`ã€‚
- åœ¨ macOS ä¸Šï¼Œä¼˜å…ˆä½¿ç”¨åº”ç”¨çš„"Remote over SSH"æ¨¡å¼ï¼Œå®ƒä¼šè‡ªåŠ¨ç®¡ç†éš§é“ã€‚

## macOS åº”ç”¨"Remote over SSH"

macOS èœå•æ åº”ç”¨å¯ä»¥ç«¯åˆ°ç«¯é©±åŠ¨ç›¸åŒçš„è®¾ç½®ï¼ˆè¿œç¨‹çŠ¶æ€æ£€æŸ¥ã€WebChat å’Œè¯­éŸ³å”¤é†’è½¬å‘ï¼‰ã€‚

æ“ä½œæ‰‹å†Œï¼š[macOS è¿œç¨‹è®¿é—®](/platforms/mac/remote)ã€‚

## å®‰å…¨è§„åˆ™ï¼ˆè¿œç¨‹/VPNï¼‰

ç®€çŸ­ç‰ˆæœ¬ï¼š**ä¿æŒ Gateway ç½‘å…³ä»… loopback**ï¼Œé™¤éžä½ ç¡®å®šéœ€è¦ç»‘å®šã€‚

- **Loopback + SSH/Tailscale Serve** æ˜¯æœ€å®‰å…¨çš„é»˜è®¤è®¾ç½®ï¼ˆæ— å…¬å¼€æš´éœ²ï¼‰ã€‚
- **éž loopback ç»‘å®š**ï¼ˆ`lan`/`tailnet`/`custom`ï¼Œæˆ–å½“ loopback ä¸å¯ç”¨æ—¶çš„ `auto`ï¼‰å¿…é¡»ä½¿ç”¨èº«ä»½éªŒè¯ä»¤ç‰Œ/å¯†ç ã€‚
- `gateway.remote.token` **ä»…**ç”¨äºŽè¿œç¨‹ CLI è°ƒç”¨â€”â€”å®ƒ**ä¸**å¯ç”¨æœ¬åœ°èº«ä»½éªŒè¯ã€‚
- `gateway.remote.tlsFingerprint` åœ¨ä½¿ç”¨ `wss://` æ—¶å›ºå®šè¿œç¨‹ TLS è¯ä¹¦ã€‚
- å½“ `gateway.auth.allowTailscale: true` æ—¶ï¼Œ**Tailscale Serve** å¯ä»¥é€šè¿‡èº«ä»½æ ‡å¤´è¿›è¡Œèº«ä»½éªŒè¯ã€‚å¦‚æžœä½ æƒ³ä½¿ç”¨ä»¤ç‰Œ/å¯†ç ï¼Œè¯·å°†å…¶è®¾ç½®ä¸º `false`ã€‚
- å°†æµè§ˆå™¨æŽ§åˆ¶è§†ä¸ºæ“ä½œå‘˜è®¿é—®ï¼šä»…é™ tailnet + æœ‰æ„çš„èŠ‚ç‚¹é…å¯¹ã€‚

æ·±å…¥äº†è§£ï¼š[å®‰å…¨](/gateway/security)ã€‚

